# BveTs向け TRViS連携用ローカルサーバ

このソフトウェアは、AtsEXを用いて開発した、TRViSとBveTsを連携させるためのローカルサーバです。
BVEの情報をTRViSに送信することができます。

なお、現時点では時刻表データの送信にのみ対応しています。

## インストール方法

1. zipファイルをダウンロードし、適当な場所に展開してください
2. zipファイル内の `TRViS.LocalServers.BveTs.dll` および `TRViS.LocalServers.BveTs.deps` を、AtsEXの拡張機能ディレクトリにコピーしてください
3. BVEを起動してください。初回のみ「ファイアウォールの例外を追加しますか？」というようなダイアログが表示されますので、「はい」を選択してください

以上でインストールとセットアップは完了です。
以降、BVEを起動すると自動でサーバが起動します。

## 使い方

(TRViSの最新版をインストールしていない場合は、あらかじめインストールしておいてください。)

1. BVEを起動し、右クリックメニューより「TRViS用QRコードを表示」を選択してください
2. ブラウザにQRコードが表示されるので、それを表示しつつスマートフォンでの作業に移ります。
3. QRコードをiOSデバイスのカメラで読み取ってください
4. TRViSを起動するか尋ねられるので、表示をタップしてTRViSを起動してください
5. TRViSが起動したら、開くファイルの確認ダイアログが表示されるので、「OK」を選択してください
6. その後、ファイルサイズの確認ダイアログが表示されるので、「OK」を選択してください
7. ロード完了ダイアログが表示されるので、「OK」を選択してください

以上で、TRViSとBVEの連携が完了します。
あとは、メニューより「D-TAC」を選択し、「時刻表」タブを開くだけです。

別のシナリオを起動した場合は、再度データを取得する必要があります。
QRコードを読み取っても構いませんが、TRViSホーム画面の「Load from Web」ボタンにて過去の表示履歴を確認できるので、そこから選択することもできます。

なお、列車位置の連動機能は未実装なため、位置情報マーカーは各行タップにて移動させる必要があります。

## 注意事項

- このソフトウェアは、あなたのパソコンにとても簡易なHTTPサーバを立てます。信頼できないネットワークに接続している場合は、このソフトウェアを使用しないでください。
- BVEから取得できる情報には限界があるため、TRViSの全ての機能を網羅できているわけではありません。

## ライセンス

このソフトウェアは、MITライセンスのもとで公開されています。
また、このソフトウェアにはMITライセンスのもとで公開されている[qrcodejs](https://github.com/davidshimjs/qrcodejs)が埋め込まれています。
